#!/bin/sh

. ./testing.sh

evtraceroute_test()
{
	opt="$1"
	target="$2"
	name="$3"

	filebase=evtraceroute-data/"evtraceroute-$name"
	output="$filebase".out
	packets="$filebase".json
	export ATLAS_TESTS=yes ATLAS_UNSAFE=yes
	r=$(cat "$output"; echo x); r=${r%?}
	testing "evtraceroute-$name" "evtraceroute $opt -R $packets $target" "$r" "" ""
}

evtraceroute_test "-6 -I" ping.ripe.json "6"
evtraceroute_test "-4 -I" ping.ripe.json "4"
evtraceroute_test "-6 -U" ping.ripe.json "6U"
evtraceroute_test "-4 -U" ping.ripe.json "4U"
evtraceroute_test "-6 -T" ping.ripe.json "6T"
evtraceroute_test "-4 -T" ping.ripe.json "4T"
evtraceroute_test "-6 -A 42 -I" ping.ripe.json "A42"
evtraceroute_test "-6 -A 42 -B 43 -I" ping.ripe.json "B43"
evtraceroute_test "-6 -a 32 -I" ping.ripe.json "a32"
evtraceroute_test "-6 -a 32 -b 2 -I" ping.ripe.json "b2"
evtraceroute_test "-6 -c 4 -I" ping.ripe.json "c4"
evtraceroute_test "-6 -f 3 -I" ping.ripe.json "f3"
evtraceroute_test "-6 -m 2 -I" ping.ripe.json "m2"
evtraceroute_test "-6 -g 2 -I" g.root-servers.json "g2"
evtraceroute_test "-6 -p 443 -T" www.ripe.json "p443"
evtraceroute_test "-6 -S 0 -I" ping.ripe.json "S0"
evtraceroute_test "-6 -S 1024 -I" ping.ripe.json "S1024"
evtraceroute_test "-6 -S 2048 -I" ping.ripe.json "S2048"
evtraceroute_test "-6 -F -S 1352 -I" ping.ripe.json "F"
evtraceroute_test "-6 -H 512 -I" ping.ripe.json "H512"
evtraceroute_test "-6 -D 512 -I" ping.ripe.json "D512"
evtraceroute_test "-6 -t 128 -I" ping.ripe.json "t128"
